{"ast":null,"code":"export const createExtendBrokerImplementation = portMap => partialBrokerImplementation => ({\n  ...partialBrokerImplementation,\n  connect: ({\n    call\n  }) => {\n    return async () => {\n      const {\n        port1,\n        port2\n      } = new MessageChannel();\n      const portId = await call('connect', {\n        port: port1\n      }, [port1]);\n      portMap.set(port2, portId);\n      return port2;\n    };\n  },\n  disconnect: ({\n    call\n  }) => {\n    return async port => {\n      const portId = portMap.get(port);\n      if (portId === undefined) {\n        throw new Error('The given port is not connected.');\n      }\n      await call('disconnect', {\n        portId\n      });\n    };\n  },\n  isSupported: ({\n    call\n  }) => {\n    return () => call('isSupported');\n  }\n});","map":{"version":3,"names":["createExtendBrokerImplementation","portMap","partialBrokerImplementation","connect","call","port1","port2","MessageChannel","portId","port","set","disconnect","get","undefined","Error","isSupported"],"sources":["C:\\Users\\toecm\\Documents\\PureConvo\\pure-app\\node_modules\\broker-factory\\src\\factories\\extend-broker-implementation.ts"],"sourcesContent":["import { IWorkerDefinition } from 'worker-factory';\nimport { IBrokerDefinition, IDefaultBrokerDefinition } from '../interfaces';\nimport { TBrokerImplementation } from '../types';\n\nexport const createExtendBrokerImplementation =\n    (portMap: WeakMap<MessagePort, number>) =>\n    <T extends IBrokerDefinition, U extends IWorkerDefinition>(\n        partialBrokerImplementation: TBrokerImplementation<T, U>\n    ): TBrokerImplementation<T & IDefaultBrokerDefinition, U> =>\n        <TBrokerImplementation<T & IDefaultBrokerDefinition, U>>{\n            ...partialBrokerImplementation,\n            connect: ({ call }) => {\n                return async (): Promise<MessagePort> => {\n                    const { port1, port2 } = new MessageChannel();\n\n                    const portId = <number>await call('connect', { port: port1 }, [port1]);\n\n                    portMap.set(port2, portId);\n\n                    return port2;\n                };\n            },\n            disconnect: ({ call }) => {\n                return async (port: MessagePort): Promise<void> => {\n                    const portId = portMap.get(port);\n\n                    if (portId === undefined) {\n                        throw new Error('The given port is not connected.');\n                    }\n\n                    await call('disconnect', { portId });\n                };\n            },\n            isSupported: ({ call }) => {\n                return () => call('isSupported');\n            }\n        };\n"],"mappings":"AAIA,OAAO,MAAMA,gCAAgC,GACxCC,OAAqC,IAElCC,2BAAwD,KAEA;EACpD,GAAGA,2BAA2B;EAC9BC,OAAO,EAAEA,CAAC;IAAEC;EAAI,CAAE,KAAI;IAClB,OAAO,YAAiC;MACpC,MAAM;QAAEC,KAAK;QAAEC;MAAK,CAAE,GAAG,IAAIC,cAAc,EAAE;MAE7C,MAAMC,MAAM,GAAW,MAAMJ,IAAI,CAAC,SAAS,EAAE;QAAEK,IAAI,EAAEJ;MAAK,CAAE,EAAE,CAACA,KAAK,CAAC,CAAC;MAEtEJ,OAAO,CAACS,GAAG,CAACJ,KAAK,EAAEE,MAAM,CAAC;MAE1B,OAAOF,KAAK;IAChB,CAAC;EACL,CAAC;EACDK,UAAU,EAAEA,CAAC;IAAEP;EAAI,CAAE,KAAI;IACrB,OAAO,MAAOK,IAAiB,IAAmB;MAC9C,MAAMD,MAAM,GAAGP,OAAO,CAACW,GAAG,CAACH,IAAI,CAAC;MAEhC,IAAID,MAAM,KAAKK,SAAS,EAAE;QACtB,MAAM,IAAIC,KAAK,CAAC,kCAAkC,CAAC;MACvD;MAEA,MAAMV,IAAI,CAAC,YAAY,EAAE;QAAEI;MAAM,CAAE,CAAC;IACxC,CAAC;EACL,CAAC;EACDO,WAAW,EAAEA,CAAC;IAAEX;EAAI,CAAE,KAAI;IACtB,OAAO,MAAMA,IAAI,CAAC,aAAa,CAAC;EACpC;CACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}